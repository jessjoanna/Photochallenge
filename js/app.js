!function e(t,n,i){function s(r,a){if(!n[r]){if(!t[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(o)return o(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){var n=t[r][1][e];return s(n?n:e)},u,u.exports,e,t,n,i)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<i.length;r++)s(i[r]);return s}({1:[function(e){function t(){var e=function(){var t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,n=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,i=/[^-+\dA-Z]/g,s=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e};return function(o,r,a){var l=e;if(1!==arguments.length||"[object String]"!==Object.prototype.toString.call(o)||/\d/.test(o)||(r=o,o=void 0),o=o?new Date(o):new Date,isNaN(o))throw SyntaxError("invalid date");r=String(l.masks[r]||r||l.masks["default"]),"UTC:"===r.slice(0,4)&&(r=r.slice(4),a=!0);var c=a?"getUTC":"get",u=o[c+"Date"](),h=o[c+"Day"](),p=o[c+"Month"](),d=o[c+"FullYear"](),f=o[c+"Hours"](),m=o[c+"Minutes"](),g=o[c+"Seconds"](),v=o[c+"Milliseconds"](),y=a?0:o.getTimezoneOffset(),w={d:u,dd:s(u),ddd:l.i18n.dayNames[h],dddd:l.i18n.dayNames[h+7],m:p+1,mm:s(p+1),mmm:l.i18n.monthNames[p],mmmm:l.i18n.monthNames[p+12],yy:String(d).slice(2),yyyy:d,h:f%12||12,hh:s(f%12||12),H:f,HH:s(f),M:m,MM:s(m),s:g,ss:s(g),l:s(v,3),L:s(v>99?Math.round(v/10):v),t:12>f?"a":"p",tt:12>f?"am":"pm",T:12>f?"A":"P",TT:12>f?"AM":"PM",Z:a?"UTC":(String(o).match(n)||[""]).pop().replace(i,""),o:(y>0?"-":"+")+s(100*Math.floor(Math.abs(y)/60)+Math.abs(y)%60,4),S:["th","st","nd","rd"][u%10>3?0:(u%100-u%10!=10)*u%10]};return r.replace(t,function(e){return e in w?w[e]:e.slice(1,e.length-1)})}}();e.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},e.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(t,n){return e(this,t,n)},Array.prototype.pluck=function(e){return this.map(function(t){return t[e]})},Array.prototype.where=function(e){return this.map(function(t){return t[e[0]]})},Array.prototype.unique=function(){for(var e={},t=[],n=0,i=this.length;i>n;++n)e.hasOwnProperty(this[n])||(t.push(this[n]),e[this[n]]=1);return t},Array.prototype.count=function(){var e=0;return this.forEach(function(){e++}),e},Array.prototype.max=function(e){var t=0,n=0;return this.forEach(function(e,i){e>t&&(t=e,n=i)}),"key"===e?n:t},Array.prototype.maxTimeStamp=function(){var e=new Date("0");return this.forEach(function(t){new Date(t)>e&&(e=t)}),e},Window.Application=new n,Backbone.history.start()}var n=(e("hbsfy/runtime"),e("./classes/routers/Application.js"));t()},{"./classes/routers/Application.js":20,"hbsfy/runtime":38}],2:[function(e,t){var n=e("hbsfy/runtime");t.exports=n.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s,o="function",r=t.helperMissing,a=this.escapeExpression;return'<img src="./assets/storage/'+a((s=null!=(s=t.fotoname||(null!=e?e.fotoname:e))?s:r,typeof s===o?s.call(e,{name:"fotoname",hash:{},data:i}):s))+'" />\n'},useData:!0})},{"hbsfy/runtime":38}],3:[function(e,t){var n=e("hbsfy/runtime");t.exports=n.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<a class="logout" href="index.php?page=logout">Logout</a>\n\n<button class="add blue_btn">+</button>\n\n<form enctype="multipart/form-data" method="post" name="fileinfo" id="form" class="wb-form hidden image-input">\n	<input type="text" id="day" name="day" value="1" class="form-control" />\n	<input type="text" id="group_id" name="group_id" value="2" class="form-control" />\n	<input type="file" id="imageInput" name="imageInput" class="imageInput form-control" />\n</form>\n<div class="day">\n	<p class="tcenter">Fotos</p>\n	<div class="images_wrapper">\n		<ul class="images">\n		</ul>\n\n	</div>\n\n</div>\n'},useData:!0})},{"hbsfy/runtime":38}],4:[function(e,t){var n=e("hbsfy/runtime");t.exports=n.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<a class="logout" href="index.php?page=logout">Logout</a>\n<section class="deelnemers">\n			<h1>Deelnemers</h1>\n	<header>\n		<h1><span>deelnemers</span></h1>\n	</header>\n	<article>\n		<header>\n			<h1><span>deelnemers</span></h1>\n		</header>\n		<div class="tbody"></div>\n\n		<h1 class="message">De photochallenge start met 3 deelnemers</p>\n\n<!-- <a href="day2" class="vote">vote pagina</a>\n<a href="day2" class="host">host pagina</a>\n<a href="day2" class="winner">winner pagina</a>\n -->\n	</article>\n</section>\n'},useData:!0})},{"hbsfy/runtime":38}],5:[function(e,t){var n=e("hbsfy/runtime");t.exports=n.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s,o="function",r=t.helperMissing,a=this.escapeExpression;return'<a class="logout" href="index.php?page=logout">Logout</a>\n<section class="vote">\n	<header>\n		<h1><span>vote</span></h1>\n	</header>\n	<article>\n\n		<header>\n			<h1><span>Zangtalent</span></h1>\n			<img class="titel" src="./assets/images/dag_'+a((s=null!=(s=t.day||(null!=e?e.day:e))?s:r,typeof s===o?s.call(e,{name:"day",hash:{},data:i}):s))+'.png" height="141" width="640" alt="">\n		</header>\n			<h2 class="blue tcenter">genre: pop</h2>\n			<div class="group center">\n				<h2 class="yellow tcenter">Zangtalent</h2>\n				<ul class="players center"></ul>\n			</div>\n\n	</article>\n\n	<button class="vote_button pink_btn">Stem!</button>\n\n</section>\n'},useData:!0})},{"hbsfy/runtime":38}],6:[function(e,t){var n=e("hbsfy/runtime");t.exports=n.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s,o="function",r=t.helperMissing,a=this.escapeExpression;return'<div class="players center">\n	<div>\n		<img src="" alt="">\n		<p>'+a((s=null!=(s=t.username||(null!=e?e.username:e))?s:r,typeof s===o?s.call(e,{name:"username",hash:{},data:i}):s))+'</p>\n		<input type="hidden" name="user[]" value="'+a((s=null!=(s=t.id||(null!=e?e.id:e))?s:r,typeof s===o?s.call(e,{name:"id",hash:{},data:i}):s))+'">\n		<input type="range" class="zang_'+a((s=null!=(s=t.id||(null!=e?e.id:e))?s:r,typeof s===o?s.call(e,{name:"id",hash:{},data:i}):s))+'" name="zang[]" min="0" max="10">\n		<span class="scale tleft">0</span><span class="scale tright">10</span>\n	</div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":38}],7:[function(e,t){var n=e("hbsfy/runtime");t.exports=n.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s,o="function",r=t.helperMissing,a=this.escapeExpression;return'<img src="./assets/storage/'+a((s=null!=(s=t.picture||(null!=e?e.picture:e))?s:r,typeof s===o?s.call(e,{name:"picture",hash:{},data:i}):s))+'" alt="'+a((s=null!=(s=t.username||(null!=e?e.username:e))?s:r,typeof s===o?s.call(e,{name:"username",hash:{},data:i}):s))+'">\n<p class="name">'+a((s=null!=(s=t.username||(null!=e?e.username:e))?s:r,typeof s===o?s.call(e,{name:"username",hash:{},data:i}):s))+"</p>\n"},useData:!0})},{"hbsfy/runtime":38}],8:[function(e,t){var n=e("hbsfy/runtime");t.exports=n.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s,o="function",r=t.helperMissing,a=this.escapeExpression;return'<a class="logout" href="index.php?page=logout">Logout</a>\n<section class="vote">\n	<header>\n		<h1><span>vote</span></h1>\n	</header>\n	<article>\n\n		<header>\n			<h1><span>Zangtalent</span></h1>\n			<img class="titel" src="./assets/images/dag_'+a((s=null!=(s=t.day||(null!=e?e.day:e))?s:r,typeof s===o?s.call(e,{name:"day",hash:{},data:i}):s))+'.png" height="141" width="640" alt="">\n		</header>\n			<h2 class="blue tcenter">genre: pop</h2>\n			<div class="group center">\n				<h2 class="yellow tcenter">Zangtalent</h2>\n				<ul class="players center"></ul>\n			</div>\n\n	</article>\n\n	<article>\n		<header>\n			<h1><span>Host</span></h1>\n		</header>\n\n			<img src="" alt="">\n			<h1 class="blue tcenter">Host</h1>\n\n			<div class="group center">\n				<div class="center">\n					<h2 class="yellow tcenter">Sfeer</h2>\n					<div>\n						<input type="range" class="sfeer" min="0" max="10">\n						<span class="scale tleft">0</span><span class="scale tright">10</span>\n					</div>\n				</div>\n\n				<div class="center">\n					<h2 class="yellow tcenter">Food \'n drinks</h2>\n					<div>\n						<input type="range" class="food" min="0" max="10">\n						<span class="scale tleft">0</span><span class="scale tright">10</span>\n					</div>\n				</div>\n			</div>\n\n	</article>\n\n	<button class="vote_button pink_btn">Stem!</button>\n\n</section>\n'},useData:!0})},{"hbsfy/runtime":38}],9:[function(e,t){var n=e("hbsfy/runtime");t.exports=n.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<a class="logout" href="index.php?page=logout">Logout</a>\n<section class="voted">\n	<header>\n		<h1><span>voted</span></h1>\n	</header>\n	<article>\n\n		<header>\n			<h1><span>voted</span></h1>\n			<img class="titel" src="./assets/images/gestemd.png" height="141" width="640" alt="">\n		</header>\n\n	<article>\n		<header>\n			<h1><span>Voted</span></h1>\n		</header>\n\n			<p class="tcenter">U heeft gestemd.<br />Bedankt!</p>\n			<button class="fotos tcenter blue_btn">foto\'s</button>\n\n	</article>\n\n	</article>\n</section>\n'},useData:!0})},{"hbsfy/runtime":38}],10:[function(e,t){var n=e("hbsfy/runtime");t.exports=n.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s,o="function",r=t.helperMissing,a=this.escapeExpression;return'<a class="logout" href="index.php?page=logout">Logout</a>\n<section class="winnaar">\n	<header>\n		<h1><span>winner</span></h1>\n	</header>\n	<article>\n\n		<header>\n			<h1><span>winner</span></h1>\n			<img class="titel" src="./assets/images/winner.png" height="141" width="640" alt="">\n		</header>\n\n		<div class="winner">\n			<img class="winner_bg" src="./assets/images/winnaar.png" height="439" width="552" alt="Karaoke">\n			<img class="winner_image" src="./assets/storage/'+a((s=null!=(s=t.picture||(null!=e?e.picture:e))?s:r,typeof s===o?s.call(e,{name:"picture",hash:{},data:i}):s))+'" height="340" width="340" alt="wouter">\n		</div>\n\n		<div class="winner2">\n			<div class="winner_info center tcenter">\n				<h2>'+a((s=null!=(s=t.username||(null!=e?e.username:e))?s:r,typeof s===o?s.call(e,{name:"username",hash:{},data:i}):s))+'</h2>\n				<p>Met een eindscore van:</p>\n				<span class="eindscore tcenter">'+a((s=null!=(s=t.score||(null!=e?e.score:e))?s:r,typeof s===o?s.call(e,{name:"score",hash:{},data:i}):s))+'</span>\n			</div>\n\n			<ul class="buttons">\n				<li><a class="foto pink_btn" href="#">Foto\'s</a></li>\n				<li><a class="replay blue_btn" href="index.php?page=replay">Replay</a></li>\n			</ul>\n		</div>\n\n\n	</article>\n</section>\n'},useData:!0})},{"hbsfy/runtime":38}],11:[function(e,t){var n=e("../models/Foto.js"),i=Backbone.Collection.extend({model:n,url:"api/fotos/",initialize:function(e){e&&(this.format=e.format)},methodUrl:function(e){return"read"===e&&this.format?void(this.url="api/fotos/"+this.format):void(this.url="api/fotos")},sync:function(e,t,n){t.methodUrl&&t.methodUrl(e.toLowerCase())&&(n=n||{},n.url=t.methodUrl(e.toLowerCase())),Backbone.Collection.prototype.sync.apply(this,arguments)}});t.exports=i},{"../models/Foto.js":16}],12:[function(e,t){var n=e("../models/Group.js"),i=Backbone.Collection.extend({model:n,url:"api/group/",initialize:function(e){e&&(this.user_id=e.user_id)},comparator:function(e){return e.get("id")},methodUrl:function(e){return"read"===e&&this.user_id?void(this.url="api/group/"+this.user_id):void(this.url="api/group")},sync:function(e,t,n){t.methodUrl&&t.methodUrl(e.toLowerCase())&&(n=n||{},n.url=t.methodUrl(e.toLowerCase())),Backbone.Collection.prototype.sync.apply(this,arguments)}});t.exports=i},{"../models/Group.js":17}],13:[function(e,t){var n=e("../models/Rating.js"),i=Backbone.Collection.extend({model:n,url:"api/rating/",initialize:function(e){e&&(this.group_id=e.group_id)},methodUrl:function(e){return"read"===e&&this.group_id?void(this.url="api/rating/"+this.group_id):void(this.url="api/rating")},sync:function(e,t,n){t.methodUrl&&t.methodUrl(e.toLowerCase())&&(n=n||{},n.url=t.methodUrl(e.toLowerCase())),Backbone.Collection.prototype.sync.apply(this,arguments)}});t.exports=i},{"../models/Rating.js":18}],14:[function(e,t){var n=e("../models/User.js"),i=Backbone.Collection.extend({model:n,url:"api/users/",initialize:function(e){e&&(this.par=e.user)},methodUrl:function(e){return"read"===e&&this.par?void(this.url="api/users/"+this.par):void(this.url="api/users")},sync:function(e,t,n){t.methodUrl&&t.methodUrl(e.toLowerCase())&&(n=n||{},n.url=t.methodUrl(e.toLowerCase())),Backbone.Collection.prototype.sync.apply(this,arguments)}});t.exports=i},{"../models/User.js":19}],15:[function(e,t){t.exports=e(13)},{"../models/Rating.js":18,"/Applications/MAMP/htdocs/photochallenge_nov/_js/classes/collections/RatingCollection.js":13}],16:[function(e,t){var n=Backbone.Model.extend({defaults:{fotoname:"",day:"",user_id:"",group_id:""},urlRoot:"api/fotos"});t.exports=n},{}],17:[function(e,t){var n=Backbone.Model.extend({defaults:{user_id:"",group_id:"",day:"",start_date:""},urlRoot:"api/group"});t.exports=n},{}],18:[function(e,t){var n=Backbone.Model.extend({defaults:{user_id:"",rating_item_id:"",rating_score:0,rated_user:"",group_id:""},urlRoot:"api/rating"});t.exports=n},{}],19:[function(e,t){var n=Backbone.Model.extend({defaults:{username:"",picture:"",password:"",role:""},urlRoot:"api/users"});t.exports=n},{}],20:[function(e,t){var n=e("../views/HomeView.js"),i=e("../views/FotosView.js"),s=e("../views/HostView.js"),o=e("../views/VoteView.js"),r=e("../views/VotedView.js"),a=e("../views/WinnerView.js"),l=e("../views/GeneralView.js"),c=e("../collections/UserCollection.js"),u=e("../collections/GroupCollection.js"),h=Backbone.Router.extend({routes:{general:"general",home:"home","host/:day":"host","vote/:day":"vote",voted:"voted",winner:"winner",fotos:"fotos","*actions":"initialize"},initialize:function(){this.setUser()},leadZero:function(e){return parseInt(e)<=9?"0"+e:e},setUser:function(){this.user=new c({user:"self"}),this.listenTo(this.user,"sync",this.setGroup),this.listenTo(this.user,"error",this.logout),this.user.fetch()},logout:function(){window.location.replace("index.php")},setGroup:function(){var e=this.user.models[0].attributes.id;this.groupCollection=new u({user_id:e}),this.listenTo(this.groupCollection,"sync",this.checkDay),this.groupCollection.fetch()},getDateFromToday:function(e){var t=new Date;return t.setDate(t.getDate()+e),t.format("yyyy-mm-dd")},checkDay:function(){var e=this.groupCollection.pluck("id").count(),t=this.groupCollection.models[0].attributes.day,n=this.groupCollection.models[0].attributes.start_date;if(4>e)console.log("groep nog niet compleet"),Window.Application.navigate("home",{trigger:!0});else if(0===t&&n===this.getDateFromToday(0)||1===t)Window.Application.navigate("home",{trigger:!0});else if(0===t&&n===this.getDateFromToday(-6)||6===t)console.log("final day"),Window.Application.navigate("winner",{trigger:!0});else{if(0===t)var i=this.daysBetween(this.getDateFromToday(0),n)-1;else var i=this.getDay();var s=this.userPosition();window.voted===!0?(console.log("voted"),Window.Application.navigate("voted",{trigger:!0})):i!==s?Window.Application.navigate("vote/"+i,{trigger:!0}):Window.Application.navigate("host/"+i,{trigger:!0})}},parseDate:function(e){var t=e.match(/(\d+)/g);return new Date(t[0],t[1]-1,t[2])},daysBetween:function(e,t){var n=864e5,i=this.parseDate(e).getTime(),s=this.parseDate(t).getTime(),o=Math.abs(i-s);return Math.round(o/n)},userPosition:function(){for(var e=0;e<this.groupCollection.models.length;e++){if(this.groupCollection.models[e].attributes.id===this.user.models[0].attributes.id)return this.user.models[0].attributes.id;console.log("compared "+this.groupCollection.models[e].attributes.id+" with "+this.user.models[0].attributes.id)}},getDay:function(){var e=this.groupCollection.models[0].attributes.day;return 0!==e?e-1:void 0},empty:function(){$(".container").empty()},"default":function(){console.log("404 - default"),this.navigate("general",{trigger:!0})},home:function(){this.empty(),this.home=new n,$(".container").append(this.home.render().el)},general:function(){this.empty(),this.general=new l,$(".container").append(this.general.render().el)},fotos:function(){this.empty(),this.fotos=new i,$(".container").append(this.fotos.render().el)},host:function(e){this.empty(),this.host=new s({id:e}),$(".container").append(this.host.render().el)},vote:function(e){this.empty(),this.vote=new o({id:e}),$(".container").append(this.vote.render().el)},voted:function(){this.empty(),this.vote=new r,$(".container").append(this.vote.render().el)},winner:function(){this.empty(),this.winner=new a,$(".container").append(this.winner.render().el)}});t.exports=h},{"../collections/GroupCollection.js":12,"../collections/UserCollection.js":14,"../views/FotosView.js":22,"../views/GeneralView.js":23,"../views/HomeView.js":24,"../views/HostView.js":25,"../views/VoteView.js":28,"../views/VotedView.js":29,"../views/WinnerView.js":30}],21:[function(e,t){var n=e("../../../_hbs/foto.hbs"),i=Backbone.View.extend({template:n,tagName:"li",render:function(){return this.$el.html(this.template(this.model.attributes)),this}});t.exports=i},{"../../../_hbs/foto.hbs":2}],22:[function(e,t){template=e("../../../_hbs/fotos.hbs");var n=e("../collections/FotoCollection.js"),i=e("./FotoView.js"),s=Backbone.View.extend({template:template,events:{"click .add":"clickAddFoto","change #imageInput":"submitFoto"},initialize:function(){console.log("init - FotosView"),this.fotoCollection=new n,this.listenTo(this.fotoCollection,"sync",this.renderFotos),this.fotoCollection.fetch()},renderFotos:function(){console.log("render fotos"),this.$fotos.empty(),this.fotoCollection.forEach(this.renderFoto,this)},renderFoto:function(e){console.log("render foto");var t=new i({model:e});this.$fotos.append(t.render().el)},clickAddFoto:function(){var e=$("#imageInput");e.click()},submitFoto:function(e){e.preventDefault();var t=new FormData(document.getElementById("form"));t.append("action","create"),$.ajax({url:"index.php?page=add_object",type:"POST",data:t,dataType:"json",processData:!1,contentType:!1,context:this,success:function(){document.getElementById("form").reset(),this.initialize()},error:function(e){console.log(e.responseText)}})},render:function(){return this.$el.html(this.template()),this.$fotos=this.$el.find(".images"),this}});t.exports=s},{"../../../_hbs/fotos.hbs":3,"../collections/FotoCollection.js":11,"./FotoView.js":21}],23:[function(e,t){var n=(e("../collections/UserCollection.js"),e("../collections/GroupCollection.js"),Backbone.View.extend({clickFoto:function(e){e.preventDefault(),console.log("to fotoview"),Window.Application.navigate("fotos",{trigger:!0})},getDay:function(){var e=this.groupCollection.models[0].attributes.day;return 0!==e?e-1:void 0},leadZero:function(e){return parseInt(e)<=9?"0"+e:e},parseDate:function(e){var t=e.match(/(\d+)/g);return new Date(t[0],t[1]-1,t[2])},daysBetween:function(e,t){var n=864e5,i=this.parseDate(e).getTime(),s=this.parseDate(t).getTime(),o=Math.abs(i-s);return Math.round(o/n)},getDateFromToday:function(e){var t=new Date;return t.setDate(t.getDate()+e),t.format("yyyy-mm-dd")}}));t.exports=n},{"../collections/GroupCollection.js":12,"../collections/UserCollection.js":14}],24:[function(e,t){var n=e("../../../_hbs/home.hbs"),i=e("../collections/UserCollection.js"),s=e("../collections/GroupCollection.js"),o=e("../views/UserFirstView.js"),r=Backbone.View.extend({template:n,tagName:"div",className:"deelnemers",events:{"click .vote":"clickVote","click .host":"clickHost","click .winner":"clickWinner"},initialize:function(){this.setUser()},setUser:function(){this.user=new i({user:"self"}),this.listenTo(this.user,"sync",this.setGroup),this.user.fetch()},setGroup:function(){console.log("setGroup",this.user.models[0].attributes.id);var e=this.user.models[0].attributes.id;this.groupCollection=new s({user_id:e}),this.listenTo(this.groupCollection,"sync",this.renderUsers),this.groupCollection.fetch()},clickHost:function(e){e.preventDefault(),this.navigateTo("host")},clickVote:function(e){e.preventDefault(),this.navigateTo("vote")},clickWinner:function(e){e.preventDefault(),this.navigateTo("winner")},navigateTo:function(e){Window.Application.navigate(e,{trigger:!0})},renderUsers:function(){this.$users.empty(),this.groupCollection.forEach(this.renderUser,this)},renderUser:function(e){var t=new o({model:e});this.$users.append(t.render().el)},render:function(){return this.$el.html(this.template()),this.$users=this.$el.find(".tbody"),this}});t.exports=r},{"../../../_hbs/home.hbs":4,"../collections/GroupCollection.js":12,"../collections/UserCollection.js":14,"../views/UserFirstView.js":26}],25:[function(e,t){template=e("../../../_hbs/host.hbs");var n=e("../views/UserVoteView.js"),i=e("../collections/RatingCollection.js"),s=e("../collections/UserCollection.js"),o=e("../collections/GroupCollection.js"),r=e("../views/GeneralView.js"),a=0,l=r.extend({template:template,events:{"click .vote_button":"clickVote"},initialize:function(){console.log("init - HostView"),this.collectionCount=0,this.ratingCollection=new i,this.setUser()},clickVote:function(e){e.preventDefault(),this.groupCollection.forEach(this.save_song_rating,this)},setUser:function(){this.user=new s({user:"self"}),this.listenTo(this.user,"sync",this.setGroup),this.user.fetch()},setGroup:function(){this.userId=this.user.models[0].attributes.id,this.groupCollection=new o({user_id:this.userId}),this.listenTo(this.groupCollection,"sync",this.render),this.listenTo(this.groupCollection,"sync",this.renderUsers),this.groupCollection.fetch()},renderUsers:function(){this.$users.empty(),this.groupCollection.forEach(this.renderUser,this)},renderUser:function(e){if(e.attributes.user_id!==this.userId){var t=new n({model:e});this.$users.append(t.render().el)}},save_song_rating:function(e){if(e.attributes.id!==this.user.models[0].attributes.id){var t=e.attributes.user_id,n=this.userId,i=this.$el.find(".zang_"+t).val(),s=e.attributes.group_id;this.ratingCollection.create({user_id:n,rating_item_id:1,rating_score:i,rated_user:t,group_id:s},{success:this.redirect})}},redirect:function(){a++,3===a&&(window.voted=!0,Window.Application.navigate("voted",{trigger:!0}))},render:function(){if(window.voted===!0)return void Window.Application.navigate("voted",{trigger:!0});if(console.log("render host"),null==this.groupCollection)this.$el.html(this.template());else{console.log(this.groupCollection);var e=this.groupCollection.models[0].attributes.day,t=this.groupCollection.models[0].attributes.start_date;this.groupCollection.models[0].attributes.day=0===e?this.daysBetween(this.getDateFromToday(0),t)-1:this.getDay(),this.$el.html(this.template(this.groupCollection.models[0].attributes)),this.renderUsers()}return this.$users=this.$el.find(".players"),this}});t.exports=l},{"../../../_hbs/host.hbs":5,"../collections/GroupCollection.js":12,"../collections/RatingCollection.js":13,"../collections/UserCollection.js":14,"../views/GeneralView.js":23,"../views/UserVoteView.js":27}],26:[function(e,t){template=e("../../../_hbs/userFirst.hbs");var n=Backbone.View.extend({template:template,className:"user",tagName:"div",render:function(){return console.log(this.template(this.model.attributes)),this.$el.html(this.template(this.model.attributes)),this}});t.exports=n},{"../../../_hbs/userFirst.hbs":7}],27:[function(e,t){templat=e("../../../_hbs/user.hbs");var n=Backbone.View.extend({templat:templat,className:"user",tagName:"li",render:function(){return this.$el.html(this.templat(this.model.attributes)),this}});t.exports=n},{"../../../_hbs/user.hbs":6}],28:[function(e,t){template=e("../../../_hbs/vote.hbs");var n=e("../views/UserVoteView.js"),i=e("../collections/GroupCollection.js"),s=e("../collections/UserCollection.js"),o=e("../collections/RatingCollection.js"),r=e("../views/GeneralView.js"),a=0,l=r.extend({template:template,events:{"click .vote_button":"clickVote"},initialize:function(e){this.collectionCount=0,this.ratingCollection=new o,console.log("init - VoteView",e),this.setUser()},clickVote:function(e){e.preventDefault(),this.groupCollection.forEach(this.save_song_rating,this),this.save_host_rating(this.redirect)},redirect:function(){a++,5===a&&(window.voted=!0,Window.Application.navigate("voted",{trigger:!0}))},save_host_rating:function(){var e=this.getDay();console.log(this.getDay());var t=this.groupCollection.models[e].attributes.id,n=this.groupCollection.models[e].attributes.group_id,i=this.$el.find(".sfeer").val(),s=this.$el.find(".food").val();this.ratingCollection.create({user_id:this.userId,rating_item_id:2,rating_score:i,rated_user:t,group_id:n},{success:this.redirect}),this.ratingCollection.create({user_id:this.userId,rating_item_id:3,rating_score:s,rated_user:t,group_id:n},{success:this.redirect})},save_song_rating:function(e){if(e.attributes.id!==this.user.models[0].attributes.id){var t=e.attributes.user_id,n=this.userId,i=this.$el.find(".zang_"+t).val(),s=e.attributes.group_id;this.ratingCollection.create({user_id:n,rating_item_id:1,rating_score:i,rated_user:t,group_id:s},{success:this.redirect})}},setUser:function(){this.user=new s({user:"self"}),this.listenTo(this.user,"sync",this.setGroup),this.user.fetch()},setGroup:function(){this.userId=this.user.models[0].attributes.id,this.groupCollection=new i({user_id:this.userId}),this.listenTo(this.groupCollection,"sync",this.render),this.listenTo(this.groupCollection,"sync",this.renderUsers),this.groupCollection.fetch()},renderUsers:function(){this.$users.empty(),this.groupCollection.forEach(this.renderUser,this)},renderUser:function(e){if(e.attributes.user_id!==this.userId){var t=new n({model:e});this.$users.append(t.render().el)}},render:function(){if(window.voted===!0)return void Window.Application.navigate("voted",{trigger:!0});if(console.log("render vote"),void 0===this.groupCollection)this.$el.html(this.template());else{var e=this.groupCollection.models[0].attributes.day,t=this.groupCollection.models[0].attributes.start_date;this.groupCollection.models[0].attributes.day=0===e?this.daysBetween(this.getDateFromToday(0),t)-1:this.getDay(),this.$el.html(this.template(this.groupCollection.models[0].attributes))}return this.$users=this.$el.find(".players"),this}});t.exports=l},{"../../../_hbs/vote.hbs":8,"../collections/GroupCollection.js":12,"../collections/RatingCollection.js":13,"../collections/UserCollection.js":14,"../views/GeneralView.js":23,"../views/UserVoteView.js":27}],29:[function(e,t){template=e("../../../_hbs/voted.hbs");var n=e("../views/GeneralView.js"),i=n.extend({template:template,events:{"click .fotos":"clickFoto"},initialize:function(){console.log("init - WinnerView")},render:function(){return this.$el.html(this.template()),this}});t.exports=i},{"../../../_hbs/voted.hbs":9,"../views/GeneralView.js":23}],30:[function(e,t){template=e("../../../_hbs/winner.hbs");var n=e("../collections/GroupCollection.js"),i=e("../collections/UserCollection.js"),s=e("../collections/ratingCollection.js"),o=e("../views/GeneralView.js"),r=o.extend({template:template,events:{"click .foto":"clickFoto"},initialize:function(){console.log("init - WinnerView"),this.getUser()},getUser:function(){this.user=new i({user:"self"}),this.listenTo(this.user,"sync",this.getGroup),this.user.fetch()},getGroup:function(){this.userId=this.user.models[0].attributes.id,this.groupCollection=new n({user_id:this.userId}),this.listenTo(this.groupCollection,"sync",this.getScores),this.groupCollection.fetch()},getScores:function(){var e=this.groupCollection.models[0].attributes.group_id;console.log(e),this.ratingCollection=new s({group_id:e}),this.listenTo(this.ratingCollection,"sync",this.calculateScores),this.ratingCollection.fetch()},calculateScores:function(){this.scoreList=[],this.ratingCollection.forEach(this.calculateScore,this),this.winnerScore=this.scoreList.max(),this.winnerId=this.scoreList.max("key"),console.log(this.scoreList.max()),console.log(this.scoreList.max("key")),this.winner=new i({user:this.winnerId}),this.listenTo(this.winner,"sync",this.render),this.winner.fetch()},calculateScore:function(e){var t=parseInt(e.attributes.rated_user),n=parseInt(e.attributes.rating_score);this.scoreList[t]?this.scoreList[t]+=n:this.scoreList[t]=n},render:function(){return console.log("this.winner",this.winner),void 0===this.winner?this.$el.html(this.template()):(this.winner.models[0].attributes.score=this.winnerScore,this.$el.html(this.template(this.winner.models[0].attributes)),console.log(this.winner.models[0].attributes)),this}});t.exports=r},{"../../../_hbs/winner.hbs":10,"../collections/GroupCollection.js":12,"../collections/UserCollection.js":14,"../collections/ratingCollection.js":15,"../views/GeneralView.js":23}],31:[function(e,t,n){"use strict";var i=e("./handlebars/base"),s=e("./handlebars/safe-string")["default"],o=e("./handlebars/exception")["default"],r=e("./handlebars/utils"),a=e("./handlebars/runtime"),l=function(){var e=new i.HandlebarsEnvironment;return r.extend(e,i),e.SafeString=s,e.Exception=o,e.Utils=r,e.escapeExpression=r.escapeExpression,e.VM=a,e.template=function(t){return a.template(t,e)},e},c=l();c.create=l,c["default"]=c,n["default"]=c},{"./handlebars/base":32,"./handlebars/exception":33,"./handlebars/runtime":34,"./handlebars/safe-string":35,"./handlebars/utils":36}],32:[function(e,t,n){"use strict";function i(e,t){this.helpers=e||{},this.partials=t||{},s(this)}function s(e){e.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new r("Missing helper: '"+arguments[arguments.length-1].name+"'")}),e.registerHelper("blockHelperMissing",function(t,n){var i=n.inverse,s=n.fn;if(t===!0)return s(this);if(t===!1||null==t)return i(this);if(u(t))return t.length>0?(n.ids&&(n.ids=[n.name]),e.helpers.each(t,n)):i(this);if(n.data&&n.ids){var r=g(n.data);r.contextPath=o.appendContextPath(n.data.contextPath,n.name),n={data:r}}return s(t,n)}),e.registerHelper("each",function(e,t){if(!t)throw new r("Must pass iterator to #each");var n,i,s=t.fn,a=t.inverse,l=0,c="";if(t.data&&t.ids&&(i=o.appendContextPath(t.data.contextPath,t.ids[0])+"."),h(e)&&(e=e.call(this)),t.data&&(n=g(t.data)),e&&"object"==typeof e)if(u(e))for(var p=e.length;p>l;l++)n&&(n.index=l,n.first=0===l,n.last=l===e.length-1,i&&(n.contextPath=i+l)),c+=s(e[l],{data:n});else for(var d in e)e.hasOwnProperty(d)&&(n&&(n.key=d,n.index=l,n.first=0===l,i&&(n.contextPath=i+d)),c+=s(e[d],{data:n}),l++);return 0===l&&(c=a(this)),c}),e.registerHelper("if",function(e,t){return h(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||o.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){h(e)&&(e=e.call(this));var n=t.fn;if(o.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var i=g(t.data);i.contextPath=o.appendContextPath(t.data.contextPath,t.ids[0]),t={data:i}}return n(e,t)}),e.registerHelper("log",function(t,n){var i=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(i,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}var o=e("./utils"),r=e("./exception")["default"],a="2.0.0";n.VERSION=a;var l=6;n.COMPILER_REVISION=l;var c={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};n.REVISION_CHANGES=c;var u=o.isArray,h=o.isFunction,p=o.toString,d="[object Object]";
n.HandlebarsEnvironment=i,i.prototype={constructor:i,logger:f,log:m,registerHelper:function(e,t){if(p.call(e)===d){if(t)throw new r("Arg not supported with multiple helpers");o.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){p.call(e)===d?o.extend(this.partials,e):this.partials[e]=t},unregisterPartial:function(e){delete this.partials[e]}};var f={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(f.level<=e){var n=f.methodMap[e];"undefined"!=typeof console&&console[n]&&console[n].call(console,t)}}};n.logger=f;var m=f.log;n.log=m;var g=function(e){var t=o.extend({},e);return t._parent=e,t};n.createFrame=g},{"./exception":33,"./utils":36}],33:[function(e,t,n){"use strict";function i(e,t){var n;t&&t.firstLine&&(n=t.firstLine,e+=" - "+n+":"+t.firstColumn);for(var i=Error.prototype.constructor.call(this,e),o=0;o<s.length;o++)this[s[o]]=i[s[o]];n&&(this.lineNumber=n,this.column=t.firstColumn)}var s=["description","fileName","lineNumber","message","name","number","stack"];i.prototype=new Error,n["default"]=i},{}],34:[function(e,t,n){"use strict";function i(e){var t=e&&e[0]||1,n=h;if(t!==n){if(n>t){var i=p[n],s=p[t];throw new u("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+s+").")}throw new u("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function s(e,t){if(!t)throw new u("No environment passed to template");if(!e||!e.main)throw new u("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var n=function(n,i,s,o,r,a,l,h,p){r&&(o=c.extend({},o,r));var d=t.VM.invokePartial.call(this,n,s,o,a,l,h,p);if(null==d&&t.compile){var f={helpers:a,partials:l,data:h,depths:p};l[s]=t.compile(n,{data:void 0!==h,compat:e.compat},t),d=l[s](o,f)}if(null!=d){if(i){for(var m=d.split("\n"),g=0,v=m.length;v>g&&(m[g]||g+1!==v);g++)m[g]=i+m[g];d=m.join("\n")}return d}throw new u("The partial "+s+" could not be compiled when running in runtime-only mode")},i={lookup:function(e,t){for(var n=e.length,i=0;n>i;i++)if(e[i]&&null!=e[i][t])return e[i][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:c.escapeExpression,invokePartial:n,fn:function(t){return e[t]},programs:[],program:function(e,t,n){var i=this.programs[e],s=this.fn(e);return t||n?i=o(this,e,s,t,n):i||(i=this.programs[e]=o(this,e,s)),i},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=c.extend({},t,e)),n},noop:t.VM.noop,compilerInfo:e.compiler},s=function(t,n){n=n||{};var o=n.data;s._setup(n),!n.partial&&e.useData&&(o=l(t,o));var r;return e.useDepths&&(r=n.depths?[t].concat(n.depths):[t]),e.main.call(i,t,i.helpers,i.partials,o,r)};return s.isTop=!0,s._setup=function(n){n.partial?(i.helpers=n.helpers,i.partials=n.partials):(i.helpers=i.merge(n.helpers,t.helpers),e.usePartial&&(i.partials=i.merge(n.partials,t.partials)))},s._child=function(t,n,s){if(e.useDepths&&!s)throw new u("must pass parent depths");return o(i,t,e[t],n,s)},s}function o(e,t,n,i,s){var o=function(t,o){return o=o||{},n.call(e,t,e.helpers,e.partials,o.data||i,s&&[t].concat(s))};return o.program=t,o.depth=s?s.length:0,o}function r(e,t,n,i,s,o,r){var a={partial:!0,helpers:i,partials:s,data:o,depths:r};if(void 0===e)throw new u("The partial "+t+" could not be found");return e instanceof Function?e(n,a):void 0}function a(){return""}function l(e,t){return t&&"root"in t||(t=t?d(t):{},t.root=e),t}var c=e("./utils"),u=e("./exception")["default"],h=e("./base").COMPILER_REVISION,p=e("./base").REVISION_CHANGES,d=e("./base").createFrame;n.checkRevision=i,n.template=s,n.program=o,n.invokePartial=r,n.noop=a},{"./base":32,"./exception":33,"./utils":36}],35:[function(e,t,n){"use strict";function i(e){this.string=e}i.prototype.toString=function(){return""+this.string},n["default"]=i},{}],36:[function(e,t,n){"use strict";function i(e){return c[e]}function s(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}function o(e){return e instanceof l?e.toString():null==e?"":e?(e=""+e,h.test(e)?e.replace(u,i):e):e+""}function r(e){return e||0===e?f(e)&&0===e.length?!0:!1:!0}function a(e,t){return(e?e+".":"")+t}var l=e("./safe-string")["default"],c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,h=/[&<>"'`]/;n.extend=s;var p=Object.prototype.toString;n.toString=p;var d=function(e){return"function"==typeof e};d(/x/)&&(d=function(e){return"function"==typeof e&&"[object Function]"===p.call(e)});var d;n.isFunction=d;var f=Array.isArray||function(e){return e&&"object"==typeof e?"[object Array]"===p.call(e):!1};n.isArray=f,n.escapeExpression=o,n.isEmpty=r,n.appendContextPath=a},{"./safe-string":35}],37:[function(e,t){t.exports=e("./dist/cjs/handlebars.runtime")},{"./dist/cjs/handlebars.runtime":31}],38:[function(e,t){t.exports=e("handlebars/runtime")["default"]},{"handlebars/runtime":37}]},{},[1]);
//# sourceMappingURL=app.js.map